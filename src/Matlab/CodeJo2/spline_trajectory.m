function [traj,dtraj] = spline_trajectory(p_1,p_2,p_3,t_1,t_2,t_3,t)
    % ---------------------------------------------------------------------------- %
    %                                     Check                                    %
    % ---------------------------------------------------------------------------- %
    if(t_2 <= t_1 || t_2 >= t_3 || t_1 >= t_3)
        error('Wrong Instant');
    end
    % ---------------------------------------------------------------------------- %

    % ---------------------------------------------------------------------------- %
    %                              Points and Instants                             %
    % ---------------------------------------------------------------------------- %

    % --------------------------------- Parameter -------------------------------- %
    Sharp = 0.30*min(norm(p_2 - p_1),norm(p_3 - p_2));
    % ---------------------------------------------------------------------------- %

    % ------------------------------- Unit Vectors ------------------------------- %
    r_12 = (p_2 - p_1)/norm(p_2 - p_1);
    r_23 = (p_3 - p_2)/norm(p_3 - p_2);
    % ---------------------------------------------------------------------------- %

    % ---------------------------------- Points ---------------------------------- %
    p_a = (p_1+p_2)/2.0;
    p_b = (p_2+p_3)/2.0;
    p_c = (p_1+p_a)/2.0;
    p_d = (p_3+p_b)/2.0;
    p_e = p_2 - Sharp*r_12;
    p_f = p_2 + Sharp*r_23;

    positions = [p_1; p_c; p_a; p_e; p_2; p_f; p_b; p_d; p_3];
    % ---------------------------------------------------------------------------- %

    % --------------------------------- Instants --------------------------------- %
    t_a = (t_1 + t_2)/2.0;
    t_b = (t_2 + t_3)/2.0;
    t_c = (t_1 + t_a)/2.0;
    t_d = (t_3 + t_b)/2.0;
    t_e = t_2 - ((t_2 - t_1)/norm(p_2 - p_1))*Sharp;
    t_f = t_2 + ((t_3 - t_2)/norm(p_3 - p_2))*Sharp;

    instants = [t_1; t_c; t_a; t_e; t_2; t_f; t_b; t_d; t_3];
    % ---------------------------------------------------------------------------- %

    % ---------------------------------------------------------------------------- %

    % ---------------------------------------------------------------------------- %
    %                                  Trajectory                                  %
    % ---------------------------------------------------------------------------- %

    % --------------------------------- Position --------------------------------- %
    traj_x = spline(instants',[0 positions(:,1)' 0]);
    traj_y = spline(instants',[0 positions(:,2)' 0]);
    % ---------------------------------------------------------------------------- %

    % --------------------------------- Velocity --------------------------------- %
    dtraj_x = fnder(traj_x);
    dtraj_y = fnder(traj_y);
    % ---------------------------------------------------------------------------- %

    % ---------------------------------------------------------------------------- %

    % ---------------------------------------------------------------------------- %
    %                                  Evaluation                                  %
    % ---------------------------------------------------------------------------- %

    % ----------------------------------- Check ---------------------------------- %
    t(t < t_1) = t_1;
    t(t > t_3) = t_3;
    % ---------------------------------------------------------------------------- %

    % --------------------------------- Position --------------------------------- %
    traj(:,1) = ppval(traj_x,t);
    traj(:,2) = ppval(traj_y,t);
    % ---------------------------------------------------------------------------- %

    % --------------------------------- Velocity --------------------------------- %
    dtraj(:,1) = ppval(dtraj_x,t);
    dtraj(:,2) = ppval(dtraj_y,t);
    % ---------------------------------------------------------------------------- %

    % ---------------------------------------------------------------------------- %
end